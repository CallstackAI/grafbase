[package]
name = "grafbase-tracing"
authors = ["Grafbase"]
description = "Tracing capabilities for Grafbase"
version = "0.1.0"
edition = "2021"
homepage = "https://grafbase.com"
repository = "https://github.com/grafbase/grafbase"
keywords = ["tracing", "grafbase"]

[lints]
workspace = true

[dependencies]
chrono = "0.4"
http.workspace = true
http-body = "1.0"
rand = "0.8"
serde = { version = "1.0", features = ["derive"] }
thiserror = "1.0"
# it's pinned to 0.9 because unfortunately opentelemetry doesn't re-export ...
# https://github.com/open-telemetry/opentelemetry-rust/issues/882
tonic = "0.9"
tower-http = { version = "0.5", optional = true, features = ["trace"] }
url = { version = "2.5", features = ["serde"] }

# tracing
tracing.workspace = true
tracing-subscriber = { workspace = true, features = ["env-filter"] }
# can't use .22 due to https://github.com/cloudflare/workers-rs/issues/439 ...
# tracing-otel uses js-sys ^0.3.64 but worker.wasm-bindgen =0.2.86 has a lower version
tracing-opentelemetry = "0.21"
# the versions below are affected by the above ...
opentelemetry = "0.20"
opentelemetry_sdk = { version = "0.20", features = ["rt-tokio"] }
opentelemetry-stdout = { version = "0.1", features = ["trace"] }
opentelemetry-otlp = { version = "0.13" , features = ["grpc-tonic", "tls", "tonic", "http-proto"] }


[features]
default = []
tower = ["tower-http"]

[dev-dependencies]
indoc = "2.0.4"
insta = "1.36.1"
tempfile = "3.10"
toml = "0.8.10"
